\chapter{Numerical experiments}
\label{chap:experiments}

\section{Stationary vortex preservation over long time integration}

The first numerical experiment we consider concerns the preservation of the steady-state solution of \ref{eq:gpe}. Since this solution is stationary, a natural way to assess the quality of our numerical method is to examine how much the approximate solution deviates from the initial one over long integration times.

In all the following experiments, we approximate the density $\rho$ by a 4-th order Pad√© approximation of the equation \ref{eq:density}

\subsection{Uniform grid}

We now present some results from the performed experiments. The parameters used in the following simulations are: $m_x = m_y = 347$, $n_t = 450$, $t^* = 20$, $L_x = L_y = 30$.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/ltufd20t347s30L.pdf}
    \caption{$\abs{\psi_0}$ (left) and $\abs{\psi(20)}$ (right), finite differences on a uniform grid.}
\end{figure}

In this figure, we can observe that the numerical solution integrated up to $t = 20$ shows slight variations in the norm outside the vortex core. To highlight this difference more clearly, we employ an alternative colormap with a steeper gradient for values close to $1$:

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/ltufd20t347s30L_color.pdf}
    \caption{Initial solution (left), solution at time $t = 20$ (right)}
\end{figure}

We observe that the variations in the norm are localized near the limit of the domain, outside the vortex core. To highlight this, Figure~\ref{fig:vortex_center} shows the truncated domain $[-5,5]$, emphasizing the vortex center.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/ltufd20t347s30L_5.pdf}
    \caption{Zoomed domain}
    \label{fig:vortex_center}
\end{figure}

From this figure, we can see that no visually appreciable variations occur near the vortex core.

\subsection{Non-uniform grid}

We now consider a non-uniformly spaced grid as described in \ref{sb:nufg}, with $\delta = h_1 = 1/50$. This results in a grid composed of 347 points per direction.

We directly report the comparison between the uniform and non-uniform grids.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/comparison_unfd.pdf}
    \caption{Comparison between uniform (left) and non-uniform (right) grids.}
\end{figure}

We can observe that the solution on the two grids visually differs only near the boundaries of the domain. In the case of the non-uniform grid, the deviation from the initial condition remains smaller.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/comparison_unfd_5.pdf}
    \caption{Zoom near the center of the domain.}
\end{figure}

Zooming into the center of the domain, again, no significant differences are observed. However, the refinement of the grid towards the origin in the non-uniform construction is clearly visible.

\section{Simulations of two straight vortices}

In this section, we simulate the dynamics of two interacting straight vortices. We perform experiments by imposing both concordant and opposite initial phases, and compare the different spatial discretization methods introduced so far.

\subsection{Simulation of marching vortices}

We now proceed to perform a set of simulations involving two straight vortices, centered respectively at $(x_{c_1}, y_{c_1})$ and $(x_{c_2}, y_{c_2})$. In this case we impose counter-rotating phases, meaning that, given the initial condition 
\[
    \psi_0 = \sqrt{\rho_1 \rho_2}\exp\bigl(\ii (S_1 + S_2)\bigr),
\] 
we have $\rho_1 = \rho(x - x_{c_1}, y - y_{c_1})$ and $S_1 = \mathrm{atan2}(y - y_{c_1}, x - x_{c_1})$, while $\rho_2 = \rho(x - x_{c_2}, y - y_{c_2})$ and $S_2 = -\mathrm{atan2}(y - y_{c_2}, x - x_{c_2})$.

All the following experiments have been carried out under the assumption of symmetry with respect to the $y$-axis, so that $x_c = x_{c_1} = -x_{c_2}$.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/str_01030_3.pdf}
    \caption{Comparison between $\psi_0$ (left), $\psi_{10}$ (center), and $\psi_{30}$ (right), for $x_c = 3$.}
\end{figure}

With this configuration, the vortices appear to march steadily towards the lateral boundaries of the computational domain. This drift is a direct consequence of the imposed counter-rotation, which breaks the otherwise stationary balance. In the following figure we can appreciate how the translation speed depends strongly on the initial separation between the vortex centers.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/str_235_30t.pdf}
    \caption{Solutions at time $t = 30$ for $x_c = 2, 3,$ and $5$.}
\end{figure}

All simulations reported here were performed on a nonuniform grid along the $x$-direction, reported in \ref{fig:mvortexgrid} with the spacing defined in \ref{sb:nufg}, while in the $y$-direction equispaced nodes were employed. This choice of discretization allows one to concentrate grid resolution where the vortex dynamics are more intense, without excessively increasing the overall computational cost.

\section{Simulation of two rotating vortex}

We now employ the initial condition given by 

\[
    \psi_0 = \sqrt{\rho_1 \rho_2}\exp\left(\ii (S_1 - S_2)\right),
\] 

with $\rho_1 = \rho(x - x_{c_1}, y - y_{c_1})$ and $S_1 = \mathrm{atan2}(y - y_{c_1}, x - x_{c_1})$, while $\rho_2 = \rho(x - x_{c_2}, y - y_{c_2})$ and $S_2 = -\mathrm{atan2}(y - y_{c_2}, x - x_{c_2})$.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/rotating.pdf}
    \caption{Initial solution (left) and solution at time $t = 22$ (right).}
\end{figure}

In this simulation, the grid was constructed according to \ref{sb:nufg} in both directions, with parameters $x_c = 3$, $h_1 = 0.05$, and $\delta = 0.025$, resulting in $m_x = m_y = 255$ grid points. The time step was set to $\tau = 0.05$.

\subsection{Comparison between uniform and nonuniform grids}

It is particularly interesting to examine how the solution changes depending on the chosen grid, while keeping the parameters fixed. We shall carry out one final experiment to compare the two grids, since in the non-stationary case we observed that the differences are much more pronounced than in the stationary one.

The following experiment was carried out using a nonuniform grid, advancing the simulation up to the time when the two vortices complete approximately a $\pi/2$ rotation. We then compare the vortex positions obtained on the uniform and nonuniform discretizations.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/comp_unfd.pdf}
    \caption{Comparison between equispaced grid and grid \ref{fig:rvortexgrid}}
\end{figure}

It is clearly visible that the solution obtained with the nonuniform grid is significantly more accurate than the one computed on a uniform grid of the same size.

In order to achieve a comparable level of accuracy with a uniform grid, it is necessary to substantially increase the number of points, reaching as high as $m_x = m_y = 771$, resulting, as well, in a much larger computational time.

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/comp_unfd_771.pdf}
    \caption{Comparison between uniform grid with $m = 771$ (left) and non uniform grid with $m = 255$ (right)}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/marching_grid.pdf}
    \caption{Grid used for the marching vortex simulations}
    \label{fig:mvortexgrid}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{img/rotating_grid.pdf}
    \caption{Grid used for rotating vortex simulation}
    \label{fig:rvortexgrid}
\end{figure}





