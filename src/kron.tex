\chapter{Kronecker products and its properties}

From now on, in this section $I$ denotes the identity matrix.

\begin{definition}
    Let $A \in \mathbb{R}^{m \times n}$ and $B \in \mathbb{R}^{p \times q}$. 
    The \emph{Kronecker product} is defined as
    \[
        A \kron B = 
        \begin{bmatrix}
            a_{11}B & \cdots & a_{1n}B \\
            \vdots & \ddots & \vdots \\
            a_{m1}B & \cdots & a_{mn}B
        \end{bmatrix} \in \mathbb{R}^{mp \times nq}.
    \]
    \label{ch:krondef}
\end{definition}

\begin{example}
\[
    \begin{bmatrix}
        1 & 2 \\
        3 & 4
    \end{bmatrix}
    \kron
    \begin{bmatrix}
        0 & 5 \\
        6 & 7
    \end{bmatrix} 
    =
    \begin{bmatrix}
        0 & 5 & 0 & 10 \\
        6 & 7 & 12 & 14 \\
        0 & 15 & 0 & 20 \\
        18 & 21 & 24 & 28
    \end{bmatrix}.
\]
\end{example}

\begin{proposition}
    If $A,B,C,D$ are matrices of compatible dimensions, then
    \[
        (A \kron B)(C \kron D) = (AC) \kron (BD).
    \]
    \label{prop:prod}
\end{proposition}

\begin{proof}
    The $(i,j)$ block of $(A \kron B)(C \kron D)$ is
    \[
        \sum_k (a_{ik}B)(c_{kj}D) = \Big(\sum_k a_{ik}c_{kj}\Big) BD = (AC)_{ij}BD,
    \]
    which coincides with the $(i,j)$ block of $(AC) \kron (BD)$.
\end{proof}

\begin{proposition}
    Let $A \in \C^{m \times m}$, $B \in \C^{n \times n}$, such that $[A,B] = 0$ and $\uu \in \C^{mn}$. Then 

    \[(A \kron B)\uu = \mathrm{vec}\left(BUA^T\right)\]

    where $\uu = \mathrm{vec}(U)$, $U_{i,j} =  u_{i + m(j - 1)}$ 

    \label{prop:tensorprod}
\end{proposition}

\begin{proof}

    \[
        \left(A \kron B\right)_{\left(i-1\right)m+k,\;\left(j-1\right)m+\ell} 
        = a_{i,j}\,b_{k,\ell},
    \]

    where $1 \leq i,j \leq n$ and $1 \leq k,\ell \leq m$.

    The component of the product $\left(A \kron B\right)\uu$ corresponding to 
    row index $\left(i-1\right)m+k$ is, by definition,

    \begin{align*}
        \left(\left(A \kron B\right)\uu\right)_{\left(i-1\right)m+k}
        &= \sum_{j=1}^n \sum_{\ell=1}^m 
        \left(A \kron B\right)_{\left(i-1\right)m+k,\;\left(j-1\right)m+\ell}\; 
        u_{\left(j-1\right)m+\ell} \\
        &= \sum_{j=1}^n \sum_{\ell=1}^m a_{i,j}\,b_{k,\ell}\; U_{\ell,j},
    \end{align*}

    Reordering the sums and factoring out $a_{i,j}$ gives
    \[
        \left(\left(A \kron B\right)\uu\right)_{\left(i-1\right)m+k}
        = \sum_{\ell=1}^m b_{k,\ell}\left(\sum_{j=1}^n U_{\ell,j}\,a_{i,j}\right).
    \]

    The inner sum is exactly the $\left(\ell,i\right)$-entry of the matrix $UA^T$, since
    \[
        \left(UA^T\right)_{\ell,i} 
        = \sum_{j=1}^n U_{\ell,j}\,\left(A^T\right)_{j,i} 
        = \sum_{j=1}^n U_{\ell,j}\,a_{i,j}.
    \]
    Therefore,
    \[
        \left(\left(A \kron B\right)\uu\right)_{\left(i-1\right)m+k}
        = \sum_{\ell=1}^m b_{k,\ell}\,\left(UA^T\right)_{\ell,i}
        = \left(B\,UA^T\right)_{k,i}.
    \]
    
    Since this holds for all $i=1,\dots,n$ and $k=1,\dots,m$, we conclude that

    \[
        \left(A \kron B\right)\,\mathrm{vec}(U) = \mathrm{vec}\!\left(B\,U\,A^T\right).
    \]

\end{proof}




\begin{lemma}
    For every $n \in \mathbb{N}$, one has
    \[
        (I \kron A)^n = I \kron A^n.
    \]
\end{lemma}

\begin{proof}
    By induction on $n$. For $n=1$ the claim is trivial. Suppose it holds for $n-1$; then
    \[
        (I \kron A)^{n} = (I \kron A)(I \kron A)^{n-1} =(I \kron A)(I \kron A^{n-1}) = I \cdot I \kron A \cdot A^{n-1} = I \kron A^{n}
    \]
    where we used the previous proposition.
\end{proof}

\begin{lemma}
    Let $A,B \in \C^{m \times n}$ and $X$ a matrix. Then $X \kron A + X \kron B = X \kron (A + B)$.
\end{lemma}

\begin{proposition}
    Let $\left\{A_k\right\}_{k = 1}^\infty$ be a sequence of matrices, where $A_j \in \C^{m \times n}$ for all $j$. Let $I$ be the identity matrix of arbitrary dimensions. Then 
    \[ \sum_{k = 1}^\infty \left(I_k \kron A_k\right) = I_k \kron \sum_{k = 1}^\infty A_k \]
\end{proposition}

\begin{proof}
    We consider the infinite sum as the limit of a partial sum as $\sum_{k = 1}^\infty \left(I \kron A_k\right) = \lim_{n \to \infty} \sum_{k = 1}^n \left(I \kron A_k\right)$.

    We now proceed for induction on $n$. For $n = 1$ the claim is trivial. Suppose it holds for $n-1$, then 

    \[
        \sum_{k = 1}^n \left(I \kron A_k\right) = I \kron A_n + \sum_{k = 1}^{n-1} \left(I \kron A_k\right) = I \kron A_n + I \kron \sum_{k = 1}^{n-1} A_k = I \kron \sum_{k = 1}^n A_k
    \]
\end{proof}

\begin{theorem}
    Let $f$ be an analytic function. Then

    \[
        f(I \kron A) = I \kron f(A) \quad \text{and} \quad f(A \kron I) = f(A) \kron I
    \]

    \label{th:analytic}
\end{theorem}

\begin{proof}
    Write $f(X) = \sum_{k=0}^\infty \alpha_k X^k$. Then
    \[
        f(I \kron A) = \sum_{k=0}^\infty \alpha_k (I \kron A)^k
        = \sum_{k=0}^\infty \alpha_k (I \kron A^k)
        = I \kron \left(\sum_{k=0}^\infty \alpha_k A^k\right)
        = I \kron f(A).
    \]

    We proceed in the same way for the other.
\end{proof}


